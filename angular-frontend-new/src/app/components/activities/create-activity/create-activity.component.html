<mat-card class="activity-card">
  <mat-card-title>Create New Activity</mat-card-title>
  <mat-card-content>
    <form [formGroup]="activityForm" (ngSubmit)="onSubmit()" class="activity-form">

      <mat-form-field appearance="outline">
        <mat-label>Title</mat-label>
        <input matInput formControlName="title" required />
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Date</mat-label>
        <input matInput [matDatepicker]="picker" formControlName="date" />
        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
        <mat-datepicker #picker></mat-datepicker>
      </mat-form-field>

      <div class="map-container">
        <h3>Select Location</h3>
        <google-map height="300px" width="100%"
                    [center]="center"
                    [zoom]="zoom"
                    (mapClick)="onMapClick($event)">
          <map-marker *ngIf="markerPosition" [position]="markerPosition!"></map-marker>
        </google-map>
        <mat-form-field class="invisible" appearance="outline" style="margin-top: 0.5rem;">
          <mat-label>Selected Location</mat-label>
          <input matInput formControlName="location" readonly />
        </mat-form-field>
      </div>

      <mat-form-field appearance="outline">
        <mat-label>Description</mat-label>
        <textarea matInput formControlName="description" rows="3"></textarea>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Duration</mat-label>
        <input matInput formControlName="duration" />
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Organization</mat-label>
        <input matInput formControlName="organization" />
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Expires At</mat-label>
        <input matInput [matDatepicker]="expPicker" formControlName="expiresAt" />
        <mat-datepicker-toggle matSuffix [for]="expPicker"></mat-datepicker-toggle>
        <mat-datepicker #expPicker></mat-datepicker>
      </mat-form-field>

      <!-- Dynamic fields -->
      <section class="chips-section">
        <h3>Skills</h3>
        <mat-chip-listbox>
          <mat-chip *ngFor="let skill of skills.controls; let i = index" (removed)="removeSkill(i)">
            {{ skill.value }}
            <button matChipRemove><mat-icon>cancel</mat-icon></button>
          </mat-chip>
          <input placeholder="Add skill..." #skillInput (keyup.enter)="addSkill(skillInput)" />
        </mat-chip-listbox>
      </section>

      <section class="chips-section">
        <h3>Qualifications</h3>
        <mat-chip-listbox>
          <mat-chip *ngFor="let q of qualifications.controls; let i = index" (removed)="removeQualification(i)">
            {{ q.value }}
            <button matChipRemove><mat-icon>cancel</mat-icon></button>
          </mat-chip>
          <input placeholder="Add qualification..." #qInput (keyup.enter)="addQualification(qInput)" />
        </mat-chip-listbox>
      </section>

      <section class="chips-section">
        <h3>Prerequisites</h3>
        <mat-chip-listbox>
          <mat-chip *ngFor="let p of prerequisites.controls; let i = index" (removed)="removePrerequisite(i)">
            {{ p.value }}
            <button matChipRemove><mat-icon>cancel</mat-icon></button>
          </mat-chip>
          <input placeholder="Add prerequisite..." #pInput (keyup.enter)="addPrerequisite(pInput)" />
        </mat-chip-listbox>
      </section>

      <div class="submit-container">
        <button mat-raised-button color="primary" type="submit" [disabled]="activityForm.invalid">
          Create Activity
        </button>
      </div>

    </form>
  </mat-card-content>
</mat-card>
